<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ã‚µã‚¤ãƒˆç¢ºèªãã‚“ - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚«ãƒ¼</title>
    <style>
        /* --- CSSï¼ˆãƒšãƒ¼ã‚¸ã®è¦‹ãŸç›®ã‚’æ•´ãˆã‚‹ï¼‰ --- */
        body {
            font-family: sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        h2 {
            color: #555;
            margin-top: 30px;
        }
        #urlInput {
            width: 500px;
            padding: 10px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 4px;
        }
        button {
            padding: 10px 20px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            margin-left: 10px;
        }
        button:hover {
            background-color: #45a049;
        }
        
        /* ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯çµæœ */
        #securityCheck {
            margin-top: 20px;
        }
        .check-section {
            margin: 20px 0;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
            border-left: 4px solid #4CAF50;
        }
        .check-section h3 {
            margin-top: 0;
            color: #333;
        }
        .check-item {
            display: flex;
            align-items: center;
            padding: 8px;
            margin: 5px 0;
            background-color: white;
            border-radius: 3px;
        }
        .check-item.good {
            border-left: 3px solid #4CAF50;
        }
        .check-item.warning {
            border-left: 3px solid #ff9800;
        }
        .check-item.bad {
            border-left: 3px solid #f44336;
        }
        .status-icon {
            margin-right: 10px;
            font-weight: bold;
            font-size: 18px;
        }
        .good .status-icon {
            color: #4CAF50;
        }
        .warning .status-icon {
            color: #ff9800;
        }
        .bad .status-icon {
            color: #f44336;
        }
        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }
        .error {
            color: #f44336;
            padding: 20px;
            background-color: #ffebee;
            border-radius: 5px;
        }
        
        /* --- iframeãƒã‚§ãƒƒã‚¯ç”¨ --- */
        #iframeContainer {
            position: relative;
            width: 100%;
            max-width: 800px;
            height: 600px;
            border: 2px dashed #aaa;
            margin-top: 20px;
            background-color: #f9f9f9;
            border-radius: 5px;
        }
        #victimFrame {
            width: 100%;
            height: 100%;
            border: none;
            opacity: 0.5; 
            border-radius: 5px;
        }
        .message {
            padding: 20px;
            text-align: center;
            color: #555;
        }
        .tabs {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            border-bottom: 2px solid #ddd;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background-color: #f0f0f0;
            border: none;
            border-radius: 5px 5px 0 0;
            font-size: 16px;
        }
        .tab.active {
            background-color: #4CAF50;
            color: white;
        }
        .tab-content {
            display: none;
            padding: 20px 0;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”’ ã‚µã‚¤ãƒˆç¢ºèªãã‚“ - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚«ãƒ¼</h1>
        <p>Webã‚µã‚¤ãƒˆã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã¨SSLè¨¼æ˜æ›¸æƒ…å ±ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚</p>

        <div>
            <label for="urlInput">URL:</label>
            <input type="text" id="urlInput" placeholder="https://example.com">
            <button id="checkButton">ãƒã‚§ãƒƒã‚¯é–‹å§‹</button>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('security')">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯</button>
            <button class="tab" onclick="switchTab('clickjacking')">ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°ç¢ºèª</button>
        </div>

        <div id="securityTab" class="tab-content active">
            <div id="securityCheck"></div>
        </div>

        <div id="clickjackingTab" class="tab-content">
            <h2>ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°ãƒ»ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒã‚§ãƒƒã‚¯</h2>
            <p>ã“ã®ã‚µã‚¤ãƒˆãŒiframeå†…ã«é€éè¡¨ç¤ºã•ã‚Œã‚‹ã‹ç¢ºèªã—ã¾ã™ã€‚</p>
            <div id="iframeContainer">
                <div class="message">ãƒã‚§ãƒƒã‚¯é–‹å§‹ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</div>
            </div>
        </div>
    </div>


    <script>
        let currentUrl = '';
        
        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
        function switchTab(tabName) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));
            
            if (tabName === 'security') {
                tabs[0].classList.add('active');
                document.getElementById('securityTab').classList.add('active');
            } else {
                tabs[1].classList.add('active');
                document.getElementById('clickjackingTab').classList.add('active');
            }
        }
        
        // ãƒ¡ã‚¤ãƒ³ãƒã‚§ãƒƒã‚¯å‡¦ç†
        document.getElementById('checkButton').addEventListener('click', async function() {
            let url = document.getElementById('urlInput').value;
            
            if (!url) {
                alert('URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
                return;
            }

            // URLãŒ 'http://' ã‚„ 'https://' ã§å§‹ã¾ã‚‰ãªã„å ´åˆã€ 'https://' ã‚’è£œã†
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                url = 'https://' + url;
                document.getElementById('urlInput').value = url;
            }
            
            currentUrl = url;
            
            // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œ
            await checkSecurity(url);
            
            // iframeã‚‚èª­ã¿è¾¼ã‚€
            loadIframe(url);
        });
        
        // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯
        async function checkSecurity(url) {
            const securityCheck = document.getElementById('securityCheck');
            securityCheck.innerHTML = '<div class="loading">ğŸ” ãƒã‚§ãƒƒã‚¯ä¸­...</div>';
            
            try {
                // ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIçµŒç”±ã§ãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±ã‚’å–å¾—
                const apiUrl = `/api/check?url=${encodeURIComponent(url)}`;
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || 'ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
                }
                
                // å–å¾—ã—ãŸãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±
                const headers = data.headers || {};
                
                // SSLè¨¼æ˜æ›¸æƒ…å ±ã‚’å–å¾—
                let certData = null;
                if (new URL(url).protocol === 'https:') {
                    certData = await fetchCertificateInfo(new URL(url).hostname);
                }
                
                // çµæœã‚’è¡¨ç¤º
                displayResults(headers, certData, url, data.statusCode);
                
            } catch (error) {
                console.error('Security check error:', error);
                // ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯è¡¨ç¤º
                securityCheck.innerHTML = `
                    <div class="check-section">
                        <h3>âš ï¸ æƒ…å ±ã®å–å¾—ã«ã¤ã„ã¦</h3>
                        <p>ã‚µã‚¤ãƒˆã®æƒ…å ±ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚</p>
                        <p><strong>ã‚¨ãƒ©ãƒ¼:</strong> ${error.message}</p>
                        <p>ã‚ˆã‚Šè©³ç´°ãªãƒã‚§ãƒƒã‚¯ã‚’è¡Œã†ã«ã¯ã€ä»¥ä¸‹ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ï¼š</p>
                        <ul>
                            <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ï¼ˆF12ï¼‰ã§ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¿ãƒ–ã‚’ç¢ºèª</li>
                            <li><a href="https://securityheaders.com/?q=${encodeURIComponent(url)}" target="_blank">SecurityHeaders.com</a>ã§ç¢ºèª</li>
                            <li><a href="https://www.ssllabs.com/ssltest/analyze.html?d=${encodeURIComponent(new URL(url).hostname)}" target="_blank">SSL Labs</a>ã§è¨¼æ˜æ›¸ã‚’ç¢ºèª</li>
                        </ul>
                    </div>
                    <div class="check-section">
                        <h3>ğŸ” åŸºæœ¬ãƒã‚§ãƒƒã‚¯</h3>
                        ${getBasicChecks(url)}
                    </div>
                `;
            }
        }
        
        // è¨¼æ˜æ›¸æƒ…å ±ã‚’å–å¾—
        async function fetchCertificateInfo(hostname) {
            try {
                const apiUrl = `/api/certificate?hostname=${encodeURIComponent(hostname)}`;
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    return null;
                }
                
                const data = await response.json();
                return data.success ? data : null;
            } catch (error) {
                console.error('Certificate fetch error:', error);
                return null;
            }
        }
        
        // åŸºæœ¬çš„ãªãƒã‚§ãƒƒã‚¯é …ç›®
        function getBasicChecks(url) {
            const urlObj = new URL(url);
            let html = '';
            
            // HTTPSãƒã‚§ãƒƒã‚¯
            if (urlObj.protocol === 'https:') {
                html += `<div class="check-item good">
                    <span class="status-icon">âœ“</span>
                    <span><strong>HTTPS:</strong> ä½¿ç”¨ã—ã¦ã„ã¾ã™ï¼ˆæ¨å¥¨ï¼‰</span>
                </div>`;
            } else {
                html += `<div class="check-item bad">
                    <span class="status-icon">âœ—</span>
                    <span><strong>HTTPS:</strong> HTTPSã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã›ã‚“</span>
                </div>`;
            }
            
            return html;
        }
        
        // çµæœè¡¨ç¤º
        function displayResults(headers, certData, url, statusCode) {
            const securityCheck = document.getElementById('securityCheck');
            
            // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
            let html = '<div class="check-section"><h3>ğŸ“¡ æ¥ç¶šæƒ…å ±</h3>';
            if (statusCode) {
                const statusClass = statusCode < 400 ? 'good' : 'bad';
                html += `<div class="check-item ${statusClass}">
                    <span class="status-icon">${statusCode < 400 ? 'âœ“' : 'âœ—'}</span>
                    <span><strong>HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:</strong> ${statusCode}</span>
                </div>`;
            }
            html += '</div>';
            
            // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®ãƒã‚§ãƒƒã‚¯
            html += '<div class="check-section"><h3>ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼</h3>';
            
            // CSP
            const csp = headers['content-security-policy'];
            if (csp) {
                html += `<div class="check-item good">
                    <span class="status-icon">âœ“</span>
                    <div>
                        <strong>Content-Security-Policy (CSP):</strong> ${csp}<br>
                        <small style="color: #666;">XSSæ”»æ’ƒã‚’é˜²ãã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼</small>
                    </div>
                </div>`;
            } else {
                html += `<div class="check-item warning">
                    <span class="status-icon">âš </span>
                    <div>
                        <strong>Content-Security-Policy (CSP):</strong> è¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“<br>
                        <small style="color: #666;">XSSæ”»æ’ƒã‚’é˜²ãã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼</small>
                    </div>
                </div>`;
            }
            
            // HSTS
            const hsts = headers['strict-transport-security'];
            if (hsts) {
                html += `<div class="check-item good">
                    <span class="status-icon">âœ“</span>
                    <div>
                        <strong>Strict-Transport-Security (HSTS):</strong> ${hsts}<br>
                        <small style="color: #666;">HTTPSã®å¼·åˆ¶ä½¿ç”¨ã‚’æŒ‡ç¤º</small>
                    </div>
                </div>`;
            } else {
                html += `<div class="check-item warning">
                    <span class="status-icon">âš </span>
                    <div>
                        <strong>Strict-Transport-Security (HSTS):</strong> è¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“<br>
                        <small style="color: #666;">HTTPSã®å¼·åˆ¶ä½¿ç”¨ã‚’æŒ‡ç¤º</small>
                    </div>
                </div>`;
            }
            
            // X-Frame-Options
            const xframe = headers['x-frame-options'];
            if (xframe) {
                html += `<div class="check-item good">
                    <span class="status-icon">âœ“</span>
                    <div>
                        <strong>X-Frame-Options:</strong> ${xframe}<br>
                        <small style="color: #666;">ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°æ”»æ’ƒã‚’é˜²æ­¢</small>
                    </div>
                </div>`;
            } else {
                html += `<div class="check-item warning">
                    <span class="status-icon">âš </span>
                    <div>
                        <strong>X-Frame-Options:</strong> è¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“<br>
                        <small style="color: #666;">ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°æ”»æ’ƒã‚’é˜²æ­¢</small>
                    </div>
                </div>`;
            }
            
            // Cache-Control
            const cacheControl = headers['cache-control'];
            if (cacheControl) {
                const hasNoStore = cacheControl.toLowerCase().includes('no-store');
                if (hasNoStore) {
                    html += `<div class="check-item good">
                        <span class="status-icon">âœ“</span>
                        <div>
                            <strong>Cache-Control:</strong> ${cacheControl}<br>
                            <small style="color: #666;">no-storeãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™ï¼ˆæ©Ÿå¯†æƒ…å ±ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’é˜²æ­¢ï¼‰</small>
                        </div>
                    </div>`;
                } else {
                    html += `<div class="check-item warning">
                        <span class="status-icon">âš </span>
                        <div>
                            <strong>Cache-Control:</strong> ${cacheControl}<br>
                            <small style="color: #666;">no-storeã®è¨­å®šãŒã‚ã‚Šã¾ã›ã‚“ã€‚æ©Ÿå¯†æƒ…å ±ã‚’æ‰±ã†å ´åˆã¯ no-store ã‚’æ¨å¥¨</small>
                        </div>
                    </div>`;
                }
            } else {
                html += `<div class="check-item warning">
                    <span class="status-icon">âš </span>
                    <div>
                        <strong>Cache-Control:</strong> è¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“<br>
                        <small style="color: #666;">æ©Ÿå¯†æƒ…å ±ã‚’æ‰±ã†å ´åˆã¯ no-store ã‚’æ¨å¥¨</small>
                    </div>
                </div>`;
            }
            
            // X-Content-Type-Options
            const nosniff = headers['x-content-type-options'];
            if (nosniff) {
                html += `<div class="check-item good">
                    <span class="status-icon">âœ“</span>
                    <div>
                        <strong>X-Content-Type-Options:</strong> ${nosniff}<br>
                        <small style="color: #666;">MIMEã‚¿ã‚¤ãƒ—ã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°ã‚’é˜²æ­¢ï¼ˆâ€»JSONãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã¿ã«è¨­å®šã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚HTMLãƒšãƒ¼ã‚¸ã§æ‰‹å‹•ç¢ºèªã‚’æ¨å¥¨ï¼‰</small>
                    </div>
                </div>`;
            } else {
                html += `<div class="check-item warning">
                    <span class="status-icon">âš </span>
                    <div>
                        <strong>X-Content-Type-Options:</strong> è¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“<br>
                        <small style="color: #666;">MIMEã‚¿ã‚¤ãƒ—ã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°ã‚’é˜²æ­¢ï¼ˆâ€»JSONãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã¿ã«è¨­å®šã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚HTMLãƒšãƒ¼ã‚¸ã§æ‰‹å‹•ç¢ºèªã‚’æ¨å¥¨ï¼‰</small>
                    </div>
                </div>`;
            }
            
            html += '</div>';
            
            // SSLè¨¼æ˜æ›¸æƒ…å ±
            html += '<div class="check-section"><h3>ğŸ” SSL/TLSè¨¼æ˜æ›¸</h3>';
            
            if (certData && certData.certificate) {
                const cert = certData.certificate;
                const security = certData.security;
                
                // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡
                if (security.issues && security.issues.length > 0) {
                    security.issues.forEach(issue => {
                        html += `<div class="check-item bad">
                            <span class="status-icon">âœ—</span>
                            <span>${issue}</span>
                        </div>`;
                    });
                }
                
                if (security.warnings && security.warnings.length > 0) {
                    security.warnings.forEach(warning => {
                        html += `<div class="check-item warning">
                            <span class="status-icon">âš </span>
                            <span>${warning}</span>
                        </div>`;
                    });
                }
                
                if (security.goodPoints && security.goodPoints.length > 0) {
                    security.goodPoints.forEach(point => {
                        html += `<div class="check-item good">
                            <span class="status-icon">âœ“</span>
                            <span>${point}</span>
                        </div>`;
                    });
                }
                
                // è¨¼æ˜æ›¸ã®è©³ç´°æƒ…å ±
                html += `<div class="check-item good" style="flex-direction: column; align-items: flex-start;">
                    <span class="status-icon" style="display: inline;">ğŸ“‹</span>
                    <strong>è¨¼æ˜æ›¸ã®è©³ç´°:</strong>
                    <div style="margin-left: 30px; margin-top: 10px; font-family: monospace; font-size: 13px;">
                        <div><strong>ç™ºè¡Œå…ˆ:</strong> ${cert.subject.CN || 'N/A'}</div>
                        <div><strong>ç™ºè¡Œå…ƒ:</strong> ${cert.issuer.O || 'N/A'} (${cert.issuer.CN || 'N/A'})</div>
                        <div><strong>æœ‰åŠ¹æœŸé™:</strong> ${new Date(cert.validFrom).toLocaleDateString('ja-JP')} ï½ ${new Date(cert.validTo).toLocaleDateString('ja-JP')}</div>
                        <div><strong>ã‚·ãƒªã‚¢ãƒ«ç•ªå·:</strong> ${cert.serialNumber}</div>
                        ${cert.keySize ? `<div><strong>éµã®ã‚µã‚¤ã‚º:</strong> ${cert.keySize}ãƒ“ãƒƒãƒˆ</div>` : ''}
                        ${cert.algorithm ? `<div><strong>ç½²åã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ :</strong> ${cert.algorithm}</div>` : ''}
                        <div><strong>SHA-256ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆ:</strong><br>${cert.fingerprint256}</div>
                        ${cert.subjectAltNames && cert.subjectAltNames.length > 0 ? 
                            `<div><strong>ã‚µãƒ–ã‚¸ã‚§ã‚¯ãƒˆä»£æ›¿å:</strong><br>${cert.subjectAltNames.join('<br>')}</div>` : ''}
                    </div>
                </div>`;
                
            } else {
                const urlObj = new URL(url);
                if (urlObj.protocol === 'https:') {
                    html += `<div class="check-item warning">
                        <span class="status-icon">âš </span>
                        <div>
                            <strong>è¨¼æ˜æ›¸æƒ…å ±ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ</strong><br>
                            <small style="color: #666;">ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã®éµã‚¢ã‚¤ã‚³ãƒ³ã‹ã‚‰ç¢ºèªã—ã¦ãã ã•ã„</small>
                        </div>
                    </div>`;
                } else {
                    html += `<div class="check-item bad">
                        <span class="status-icon">âœ—</span>
                        <span><strong>HTTPæ¥ç¶š:</strong> æš—å·åŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼ˆéæ¨å¥¨ï¼‰</span>
                    </div>`;
                }
            }
            
            html += `<div class="check-item good">
                <span class="status-icon">â„¹ï¸</span>
                <div>
                    <strong>è©³ç´°ç¢ºèª:</strong> <a href="https://www.ssllabs.com/ssltest/analyze.html?d=${encodeURIComponent(new URL(url).hostname)}" target="_blank">SSL Labsã§è©³ç´°ãƒã‚§ãƒƒã‚¯</a>
                </div>
            </div>`;
            html += '</div>';
            
            // ãã®ä»–ã®é‡è¦ãƒ˜ãƒƒãƒ€ãƒ¼
            html += '<div class="check-section"><h3>ğŸ“‹ ãã®ä»–ã®é‡è¦ãƒ˜ãƒƒãƒ€ãƒ¼</h3>';
            
            const otherHeaders = [
                'x-xss-protection',
                'referrer-policy',
                'permissions-policy',
                'cross-origin-opener-policy',
                'cross-origin-resource-policy',
                'cross-origin-embedder-policy'
            ];
            
            let hasOtherHeaders = false;
            otherHeaders.forEach(headerKey => {
                const value = headers[headerKey];
                if (value) {
                    hasOtherHeaders = true;
                    html += `<div class="check-item good">
                        <span class="status-icon">âœ“</span>
                        <span><strong>${headerKey}:</strong> ${value}</span>
                    </div>`;
                }
            });
            
            if (!hasOtherHeaders) {
                html += `<div class="check-item warning">
                    <span class="status-icon">â„¹ï¸</span>
                    <span>è¿½åŠ ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã¯è¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“</span>
                </div>`;
            }
            
            html += '</div>';
            
            securityCheck.innerHTML = html;
        }
        
        // iframeèª­ã¿è¾¼ã¿
        function loadIframe(url) {
            const container = document.getElementById('iframeContainer');
            container.innerHTML = ''; 

            const iframe = document.createElement('iframe');
            iframe.id = 'victimFrame';
            iframe.src = url;

            iframe.onload = function() {
                try {
                    const x = iframe.contentWindow.document;
                } catch (e) {
                    console.log("iframe loaded (cross-origin): " + url);
                }
            };
            
            iframe.onerror = function() {
                container.innerHTML = '<div class="message">ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚URLãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚</div>';
            };

            container.appendChild(iframe);
        }
    </script>

</body>
</html>